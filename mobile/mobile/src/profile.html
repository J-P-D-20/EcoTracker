<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EcoTracker | Profile</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="stylesheet" href="css/profile.css" />
  </head>
  <body>
    <div id="profile-container" class="active-page">
      <div class="profile-page">
        <div class="header">
          <a class="back-btn" href="home.html">
            <img src="assets/icon/back-arrow.png" alt="Back" />
          </a>
          <h2>Profile</h2>
          <label class="switch">
            <input type="checkbox" />
            <span class="slider"></span>
          </label>
        </div>

        <div class="profile-card">
          <img class="avatar" src="assets/imgs/pfp.jpg" alt="Profile Image" />
          <div class="user-info">
            <h3 id="name"></h3>
            <p id="email"></p>
          </div>
        </div>

        <h3 class="section-title">API Connection</h3>
        <div class="card-list">
          <div class="row">
            <div class="left">
              <img src="assets/icon/weather.png" class="icon-img" alt="Weather Icon" />
              Weather
            </div>
            <span class="status">Connected</span>
          </div>
        </div>

        <h3 class="section-title">Activity Tracker</h3>
        <div class="card-list">
          <div class="row">
            <div class="left">
              <img src="assets/icon/warning.png" class="icon-img" alt="Warning Icon" />
              Most CO₂
            </div>
            <span id="max" class="value"></span>
          </div>

          <div class="row">
            <div class="left">
              <img src="assets/icon/leaf.png" class="icon-img" alt="Leaf Icon" />
              Least CO₂
            </div>
            <span id="min" class="value"></span>
          </div>
        </div>

        <div class="menu">
          <div class="menu-item">
            <img src="assets/icon/share.png" class="icon-img" alt="Share Icon" />
            Share Progress
          </div>
          <div class="menu-item">
            <img src="assets/icon/profile.png" class="icon-img" alt="Profile Icon" />
            Manage Account
          </div>
          <div class="menu-item">
            <img src="assets/icon/settings.png" class="icon-img" alt="Settings Icon" />
            Settings
          </div>
        </div>

        <div class="navbar">
          <a class="nav-icon" href="home.html">
            <img src="assets/icon/home.png" class="nav-icon-img" alt="Home Icon" />
          </a>

          <a class="nav-icon" href="insights.html">
            <img src="assets/icon/chart.png" class="nav-icon-img" alt="Chart Icon" />
          </a>

          <a class="nav-icon" href="profile.html">
            <img src="assets/icon/user.png" class="nav-icon-img" alt="User Icon" />
          </a>
        </div>
      </div>
    </div>
  </body>

  <script>

    //first name
    fetch("http://localhost:3000/profile/fname", {
      method: "GET",
      headers: {
        "Content-Type": "application/json",
        Authorization: `Bearer ${localStorage.getItem("token")}`,
      },
    })
      .then((response) => response.json())
      .then((data) => {
        document.getElementById("name").textContent = data.fname;
      })
      .catch((error) => {
        console.error("Error fetching profile data:", error);
      });


      //email
      fetch("http://localhost:3000/profile/email", {
        method :"GET",
        headers :{
          "Content-Type": "application/json",
          Authorization: `Bearer ${localStorage.getItem("token")}`,
        }
      }).then((response) => response.json())
      .then((data) => {
        document.getElementById("email").textContent = data.email;
      }).catch((error) => {
        console.error("Error fetching profile data:", error);
      });

      //least co2
      fetch("http://localhost:3000/profile/footprints/min", {
        method :"GET",
        headers :{
          "Content-Type": "application/json",
          Authorization: `Bearer ${localStorage.getItem("token")}`,
        }
      }).then((response) => response.json())
      .then((data) => {
        document.getElementById("min").textContent = data.min.calculation_type;
      }).catch((error) => {
        console.error("Error fetching profile data:", error);
      });

    //most co2
    fetch("http://localhost:3000/profile/footprints/max", {
      method :"GET",
      headers :{
        "Content-Type": "application/json",
        Authorization: `Bearer ${localStorage.getItem("token")}`,
      }
    }).then((response) => response.json())
    .then((data) => {
      document.getElementById("max").textContent = data.max.calculation_type;
    }).catch((error) => {
      console.error("Error fetching profile data:", error);
    });

  </script>
</html>
